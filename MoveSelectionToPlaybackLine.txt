
{
	Initialize "() { 
        if (Sibelius.ProgramVersion > 20200600) {
            SetInterpreterOption(TreatSingleCharacterAsString);
            SetInterpreterOption(SupportHalfSemitonePitchValues);
        }

        AddToPluginsMenu(_PluginMenuName, 'Run');
         
    }"
    
    _PluginMenuName "Move Selection to Playhead"
	_VersionText "Version 1"
	
    Run "() {
        
        score = Sibelius.ActiveScore;
        topStaff = score.NthStaff(1);
        currentBarNumber = Sibelius.ActiveScore.CurrentPlaybackPosBar;
        bar = topStaff.NthBar(currentBarNumber);
        notesInBar = CreateSparseArray();
        
        for each NoteRest n in bar {
            if (not(n.NoteCount = 0)) {
                notesInBar.Push(n);
            }
        }

        notesInBar[0].Select();
        Sibelius.MoveActiveViewToBar(currentBarNumber);
        Sibelius.MoveActiveViewToSelection();

        }"
}
