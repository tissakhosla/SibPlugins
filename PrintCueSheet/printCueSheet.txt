
{
	Initialize "() {
AddToPluginsMenu('Print Cue Sheet','Run');

// The following enables the latest behavior for the ManuScript interpreter.
// If you intend your plugin to run on previous versions of Sibelius where that functionality
// didn't exist, you will likely have to revisit the following:
if (Sibelius.ProgramVersion > 20200600) {
    SetInterpreterOption(TreatSingleCharacterAsString);
    SetInterpreterOption(SupportHalfSemitonePitchValues);
} }"
	Run "() {
                score = Sibelius.ActiveScore;
                sysstaff = score.SystemStaff;
                Trace('Key:' & ' ' & sysstaff.InitialKeySignature.AsText);

                for each measure in sysstaff {
                    // TODOs:
                    // measure num should only appear once per result
                    // format output like 'num rl txt or key'
                    // TimeSignature and Repeats still needed

                    for each RehearsalMark elem in measure {
                        Trace(measure.BarNumber & ' ' & elem.MarkAsText);
                    }

                    for each KeySignature elem in measure {
                        Trace(measure.BarNumber & ' ' & elem.AsText);
                    }
                    
                    for each TimeSignature elem in measure {
                        Trace(measure.BarNumber & ' ' & elem.Text);
                    }

                    for each SystemTextItem elem in measure {
                        Trace(measure.BarNumber & ' ' & elem.Text);
                    }

                    for each SpecialBarline elem in measure {
                        Trace(measure.BarNumber & ' ' & elem.BarlineType);
                    }
                }
            }"
}
