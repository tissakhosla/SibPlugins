
{
	Initialize "() {
AddToPluginsMenu('Print Cue Sheet','Run');

// The following enables the latest behavior for the ManuScript interpreter.
// If you intend your plugin to run on previous versions of Sibelius where that functionality
// didn't exist, you will likely have to revisit the following:
if (Sibelius.ProgramVersion > 20200600) {
    SetInterpreterOption(TreatSingleCharacterAsString);
    SetInterpreterOption(SupportHalfSemitonePitchValues);
} }"
	Run "() {
                score = Sibelius.ActiveScore;
                sysstaff = score.SystemStaff;
                Trace('Key:' & ' ' & sysstaff.InitialKeySignature.AsText);

                for each measure in sysstaff {
                    message = '';

                    for each RehearsalMark elem in measure {
                        message = message & ' ' & elem.MarkAsText;
                    }

                    for each KeySignature elem in measure {
                        message = message & ' ' & elem.AsText;
                    }
                    
                    for each TimeSignature elem in measure {
                        message = message & ' ' & elem.Text;
                    }

                    for each SystemTextItem elem in measure {
                        message = message & ' ' & elem.Text;
                    }

                    for each SpecialBarline elem in measure {
                        if (elem.BarlineType = 'StartRepeat' or elem.BarlineType = 'EndRepeat' or elem.BarlineType = 'Final') {
                            message = message & ' ' & elem.BarlineType;                            
                        }
                    }
                
                    if (message != '') {
                        Trace(measure.BarNumber & ' ' & message);
                    }
                }
            }"
}

